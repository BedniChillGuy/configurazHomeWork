# Инструмент для учебного конфигурационного языка

CLI утилита на Python, которая парсит учебный конфигурационный язык (Lark), вычисляет константные выражения на этапе трансляции и выводит результат в формате XML.

## Возможности
- Объявление констант `имя := значение;` со значениями: числа (октал `0o...`), строки `q(...)`, массивы `{ v1. v2. }`, ссылки на ранее объявленные константы и префиксные константные выражения `[op arg1 arg2 ...]`.
- Поддерживаемые операции в выражениях: `+`, `-`, `*`, `/`, `print` (возвращает значение и пишет его в stderr при работе CLI).
- Многострочные комментарии `=begin ... =cut` игнорируются.
- Вложенные конструкции (массивы, выражения, ссылки) сохраняются в результирующем XML.
- Сообщения об ошибках для синтаксических и семантических проблем (например, использование необъявленного имени, деление на ноль).

## Установка зависимостей
Рекомендуется использовать виртуальное окружение:

```
python -m venv .venv
.venv\Scripts\activate  # Windows
# или source .venv/bin/activate на Linux/macOS
pip install -r requirements.txt
```

## Запуск CLI
Читает исходный текст из stdin и пишет XML в stdout. Результаты `print` выводятся в stderr.

```
python -m configlang.cli < examples/monitoring.conf
```

При ошибке парсера/вычислений возвращает код 1 и сообщение в stderr.

## Тесты
Используется `pytest`:

```
pytest
```

Все конструкции языка покрыты тестами: числа, строки, массивы (включая вложенные), выражения, операции, `print`, комментарии и ошибки разрешения имен.

## Формат вывода
- Корневой элемент: `<config>`.
- Каждая константа: `<const name="имя">...</const>`.
- Значения: `<number format="decimal">`, `<string>`, `<array><item>...`.
- Вложенные структуры сохраняются как вложенные элементы.

## Примеры из разных предметных областей
- `examples/monitoring.conf` — мониторинг веб‑сервиса.
- `examples/smart_home.conf` — управление умным домом.
- `examples/game_level.conf` — параметры уровня игры.

Откройте любой файл из `examples/` и прогоните через CLI, чтобы увидеть соответствующий XML.

